---
title: "Asteria-Pro: Enhancing Deep-Learning Based Binary Code Similarity
  Detection by Incorporating Domain Knowledge"
publication_types:
  - "2"
authors:
  - Shouguo Yang
  - Chaopeng Dong
  - Yang Xiao
  - Yiran Cheng
  - Zhiqiang Shi
  - Zhi Li
  - Limin Sun
publication_short: ToSEM
abstract: >-
  The widespread code reuse allows vulnerabilities to proliferate among a vast
  variety of firmware. There is an urgent need to detect these vulnerable code
  effectively and efficiently. By measuring code similarities, AI-based binary
  code similarity detection is applied to detecting vulnerable code at scale.
  Existing studies have proposed various function features to capture the
  commonality for similarity detection. Nevertheless, the significant code
  syntactic variability induced by the diversity of IoT hardware architectures
  diminishes the accuracy of binary code similarity detection. In our earlier
  study and the tool Asteria, we adopted a Tree-LSTM network to summarize
  function semantics as function commonality, and the evaluation result
  indicates an advanced performance. However, it still has utility concerns due
  to excessive time costs and inadequate precision while searching for
  large-scale firmware bugs.


  To this end, we propose a novel deep learning enhancement architecture by incorporating domain knowledge-based pre-filtration and re-ranking modules, and develop a prototype named Asteria-Pro based on Asteria. The pre-filtration module eliminates dissimilar functions, thus reducing the subsequent deep learning model calculations. The re-ranking module boosts the rankings of vulnerable functions among candidates generated by the deep learning model. Our evaluation indicates that the pre-filtration module cuts the calculation time by 96.9%, and the re-ranking module improves MRR and Recall by 23.71% and 36.4%, respectively. By incorporating these modules, Asteria-Pro outperforms existing state-of-the-art approaches in the bug search task by a significant margin. Furthermore, our evaluation shows that embedding baseline methods with pre-filtration and re-ranking modules significantly improves their precision. We conduct a large-scale real-world firmware bug search, and Asteria-Pro manages to detect 1,482 vulnerable functions with a high precision 91.65%.
draft: false
featured: false
tags: []
slides: ""
url_pdf: ""
image:
  caption: "Image credit: [**Unsplash**](https://unsplash.com/photos/pLCdAaMFLTE)"
  focal_point: ""
  preview_only: false
summary: ""
url_dataset: https://github.com/wowchemy/wowchemy-hugo-themes
url_project: ""
url_source: https://github.com/wowchemy/wowchemy-hugo-themes
url_video: https://youtube.com
author_notes: []
doi: ""
publication: ACM Transactions on Software Engineering and Methodology
projects: []
date: 2023-06-17T00:00:00.000Z
url_slides: ""
publishDate: 2017-01-01T00:00:00Z
url_poster: ""
url_code: https://github.com/wowchemy/wowchemy-hugo-themes
---

{{% callout note %}}
Click the _Cite_ button above to demo the feature to enable visitors to import publication metadata into their reference management software.
{{% /callout %}}

{{% callout note %}}
Create your slides in Markdown - click the _Slides_ button to check out the example.
{{% /callout %}}

Supplementary notes can be added here, including [code, math, and images](https://wowchemy.com/docs/writing-markdown-latex/).
