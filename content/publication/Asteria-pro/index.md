---
title: "Asteria-Pro: Enhancing Deep-Learning Based Binary Code Similarity
  Detection by Incorporating Domain Knowledge"
authors:
  - Shouguo Yang
  - admin
  - Yang Xiao
  - Yiran Cheng
  - Zhiqiang Shi
  - Zhi Li
  - Limin Sun
author_notes:
- "Equal contribution"
- "Equal contribution"
date: "2023-06-17T00:00:00.000Z"
doi: "https://dl.acm.org/doi/10.1145/3604611"

# Schedule page publish date (NOT publication's date).
publishDate: "2023-06-17T00:00:00.000Z"

# Publication type.
# Legend: 0 = Uncategorized; 1 = Conference paper; 2 = Journal article;
# 3 = Preprint / Working Paper; 4 = Report; 5 = Book; 6 = Book section;
# 7 = Thesis; 8 = Patent
publication_types: ["2"]

# Publication name and optional abbreviated publication name.
publication: "ACM Transactions on Software Engineering and Methodology"
publication_short: "ToSEM (CCF-A)"

abstract: The widespread code reuse allows vulnerabilities to proliferate among a vast
  variety of firmware. There is an urgent need to detect these vulnerable code
  effectively and efficiently. By measuring code similarities, AI-based binary
  code similarity detection is applied to detecting vulnerable code at scale.
  Existing studies have proposed various function features to capture the
  commonality for similarity detection. Nevertheless, the significant code
  syntactic variability induced by the diversity of IoT hardware architectures
  diminishes the accuracy of binary code similarity detection. In our earlier
  study and the tool Asteria, we adopted a Tree-LSTM network to summarize
  function semantics as function commonality, and the evaluation result
  indicates an advanced performance. However, it still has utility concerns due
  to excessive time costs and inadequate precision while searching for
  large-scale firmware bugs.


  To this end, we propose a novel deep learning enhancement architecture by incorporating domain knowledge-based pre-filtration and re-ranking modules, and develop a prototype named Asteria-Pro based on Asteria. The pre-filtration module eliminates dissimilar functions, thus reducing the subsequent deep learning model calculations. The re-ranking module boosts the rankings of vulnerable functions among candidates generated by the deep learning model. Our evaluation indicates that the pre-filtration module cuts the calculation time by 96.9%, and the re-ranking module improves MRR and Recall by 23.71% and 36.4%, respectively. By incorporating these modules, Asteria-Pro outperforms existing state-of-the-art approaches in the bug search task by a significant margin. Furthermore, our evaluation shows that embedding baseline methods with pre-filtration and re-ranking modules significantly improves their precision. We conduct a large-scale real-world firmware bug search, and Asteria-Pro manages to detect 1,482 vulnerable functions with a high precision 91.65%.

# Summary. An optional shortened abstract.
summary: A novel deep learning enhancement architecture by incorporating domain knowledge-based pre-filtration and re-ranking modules is proposed, and a prototype named Asteria-Pro based on Asteria is developed, which outperforms existing state-of-the-art approaches in the bug search task by a significant margin.

tags: []
featured: false

# links:
# - name: ""
#   url: ""
url_pdf: "https://gentlecp.com/publication/Asteria-pro/3604611.pdf"
url_code: 'https://github.com/Asteria-BCSD/Asteria-Pro'
url_dataset: 'https://drive.google.com/file/d/1NZALJqz5W4jowrhXdWWRfuT8fRJfBQ5z/view?usp=sharing'
url_poster: ''
url_project: ''
url_slides: ''
url_source: ''
url_video: ''

# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder. 
image:
  caption: 'The workflow of Asteria-pro'
  focal_point: ""
  preview_only: false

# Associated Projects (optional).
#   Associate this publication with one or more of your projects.
#   Simply enter your project's folder or file name without extension.
#   E.g. `internal-project` references `content/project/internal-project/index.md`.
#   Otherwise, set `projects: []`.
projects: []

# Slides (optional).
#   Associate this publication with Markdown slides.
#   Simply enter your slide deck's filename without extension.
#   E.g. `slides: "example"` references `content/slides/example/index.md`.
#   Otherwise, set `slides: ""`.
---

